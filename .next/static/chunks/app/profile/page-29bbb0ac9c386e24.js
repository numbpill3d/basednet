(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{5292:function(e,t,s){Promise.resolve().then(s.bind(s,2509))},7907:function(e,t,s){"use strict";var a=s(5313);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},2509:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(3827),n=s(4090),i=s(7907),l=s(3170),r=s(3779),o=s(8222);function c(){let e=(0,i.useRouter)(),{user:t,profile:s,isLoading:c,isAuthenticated:d,refreshUserData:u}=(0,r.a)(),[m,h]=(0,n.useState)({display_name:(null==s?void 0:s.display_name)||"",bio:(null==s?void 0:s.bio)||"",avatar_url:(null==s?void 0:s.avatar_url)||"",custom_css:(null==s?void 0:s.custom_css)||"",custom_html:(null==s?void 0:s.custom_html)||""}),[p,x]=(0,n.useState)((null==s?void 0:s.social_links)||{twitter:"",github:"",website:""}),[y,f]=(0,n.useState)(!1),[g,b]=(0,n.useState)(null),[v,j]=(0,n.useState)(null);n.useEffect(()=>{c||d||e.push("/")},[c,d,e]);let w=e=>{let{name:t,value:s}=e.target;h(e=>({...e,[t]:s}))},N=e=>{let{name:t,value:s}=e.target;x(e=>({...e,[t]:s}))},C=async e=>{e.preventDefault(),f(!0),b(null),j(null);try{let e=await o.hi.profile.updateProfile({...m,social_links:p});if(e.error)throw Error(e.error);j("Profile updated successfully!"),await u()}catch(e){b(e.message||"Failed to update profile")}finally{f(!1)}};return c?(0,a.jsxs)("div",{className:"win98-desktop",children:[(0,a.jsx)(l.Z,{}),(0,a.jsxs)("div",{className:"window",style:{maxWidth:"600px",margin:"20px auto"},children:[(0,a.jsx)("div",{className:"window-title",children:(0,a.jsx)("span",{children:"Loading..."})}),(0,a.jsx)("div",{className:"window-content",style:{textAlign:"center",padding:"20px"},children:(0,a.jsx)("div",{className:"loading-98"})})]})]}):d?(0,a.jsxs)("div",{className:"win98-desktop",children:[(0,a.jsx)(l.Z,{}),(0,a.jsxs)("div",{className:"window",style:{maxWidth:"800px",margin:"20px auto"},children:[(0,a.jsxs)("div",{className:"window-title",children:[(0,a.jsx)("span",{children:"User Profile"}),(0,a.jsx)("span",{children:"\xd7"})]}),(0,a.jsx)("div",{className:"window-content",children:(0,a.jsxs)("form",{onSubmit:C,children:[g&&(0,a.jsxs)("div",{style:{backgroundColor:"#ffdddd",border:"1px solid #ff0000",padding:"10px",marginBottom:"15px"},children:["Error: ",g]}),v&&(0,a.jsx)("div",{style:{backgroundColor:"#ddffdd",border:"1px solid #00ff00",padding:"10px",marginBottom:"15px"},children:v}),(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"5px"},children:"Username:"}),(0,a.jsx)("input",{type:"text",value:(null==t?void 0:t.username)||"",disabled:!0,className:"input-98",style:{width:"100%"}}),(0,a.jsx)("small",{children:"Username cannot be changed"})]}),(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"5px"},children:"Display Name:"}),(0,a.jsx)("input",{type:"text",name:"display_name",value:m.display_name,onChange:w,className:"input-98",style:{width:"100%"}})]}),(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"5px"},children:"Bio:"}),(0,a.jsx)("textarea",{name:"bio",value:m.bio,onChange:w,className:"input-98",style:{width:"100%",height:"100px"}})]}),(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"5px"},children:"Avatar URL:"}),(0,a.jsx)("input",{type:"text",name:"avatar_url",value:m.avatar_url,onChange:w,className:"input-98",style:{width:"100%"}})]}),(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"5px"},children:"Social Links:"}),(0,a.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"5px"},children:"Twitter:"}),(0,a.jsx)("input",{type:"text",name:"twitter",value:p.twitter,onChange:N,className:"input-98",style:{width:"100%"},placeholder:"https://twitter.com/yourusername"})]}),(0,a.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"5px"},children:"GitHub:"}),(0,a.jsx)("input",{type:"text",name:"github",value:p.github,onChange:N,className:"input-98",style:{width:"100%"},placeholder:"https://github.com/yourusername"})]}),(0,a.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"5px"},children:"Website:"}),(0,a.jsx)("input",{type:"text",name:"website",value:p.website,onChange:N,className:"input-98",style:{width:"100%"},placeholder:"https://yourwebsite.com"})]})]}),(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"5px"},children:"Custom CSS:"}),(0,a.jsx)("textarea",{name:"custom_css",value:m.custom_css,onChange:w,className:"input-98",style:{width:"100%",height:"100px",fontFamily:"monospace"},placeholder:"/* Your custom CSS here */"})]}),(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"5px"},children:"Custom HTML:"}),(0,a.jsx)("textarea",{name:"custom_html",value:m.custom_html,onChange:w,className:"input-98",style:{width:"100%",height:"100px",fontFamily:"monospace"},placeholder:"<!-- Your custom HTML here -->"})]}),(0,a.jsx)("div",{style:{textAlign:"right"},children:(0,a.jsx)("button",{type:"submit",className:"btn-98",disabled:y,children:y?"Saving...":"Save Profile"})})]})})]})]}):null}},3170:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(3827);s(4090);var n=s(8792),i=s(3779);function l(){let{user:e,isAuthenticated:t,isLoading:s,login:l,logout:r}=(0,i.a)();return(0,a.jsxs)("nav",{className:"navbar-98",children:[(0,a.jsx)("button",{className:"btn-98",children:"Start"}),(0,a.jsx)("div",{style:{marginLeft:"10px"},children:"|"}),(0,a.jsx)(n.default,{href:"/",className:"btn-98",children:"Home"}),(0,a.jsx)(n.default,{href:"/browse",className:"btn-98",children:"Browse"}),(0,a.jsx)(n.default,{href:"/webrings",className:"btn-98",children:"Webrings"}),s?(0,a.jsx)("div",{className:"loading-98",style:{marginLeft:"auto"}}):t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.default,{href:"/dashboard",className:"btn-98",children:"My Dashboard"}),(0,a.jsx)(n.default,{href:"/profile",className:"btn-98",children:"Profile"}),(0,a.jsxs)("button",{className:"btn-98",style:{marginLeft:"auto"},onClick:()=>r(),children:["Logout (",null==e?void 0:e.username,")"]})]}):(0,a.jsx)("button",{className:"btn-98",style:{marginLeft:"auto"},onClick:()=>l(),children:"Login"}),(0,a.jsx)(n.default,{href:"/help",className:"btn-98",children:"Help"})]})}},3779:function(e,t,s){"use strict";s.d(t,{H:function(){return o},a:function(){return c}});var a=s(3827),n=s(4090),i=s(1126),l=s(8222);let r=(0,n.createContext)(void 0);function o(e){let{children:t}=e,{data:s,status:o}=(0,i.useSession)(),[c,d]=(0,n.useState)(null),[u,m]=(0,n.useState)(null),[h,p]=(0,n.useState)(!0),[x,y]=(0,n.useState)(null),f=async()=>{if(!(null==s?void 0:s.user)){d(null),m(null),p(!1);return}try{var e,t;p(!0),y(null);let s=await l.hi.user.getCurrentUser();if(s.error)throw Error(s.error);d((null===(e=s.data)||void 0===e?void 0:e.user)||null);let a=await l.hi.profile.getProfile();if(a.error)throw Error(a.error);m((null===(t=a.data)||void 0===t?void 0:t.profile)||null)}catch(e){console.error("Error fetching user data:",e),y(e.message)}finally{p(!1)}};(0,n.useEffect)(()=>{"loading"!==o&&f()},[s,o]);let g=async()=>{try{await (0,i.signIn)("indieauth",{callbackUrl:"/"})}catch(e){console.error("Login error:",e),y(e.message)}},b=async()=>{try{await (0,i.signOut)({callbackUrl:"/"}),d(null),m(null)}catch(e){console.error("Logout error:",e),y(e.message)}},v=async()=>{await f()};return(0,a.jsx)(r.Provider,{value:{user:c,profile:u,isLoading:h,isAuthenticated:!!c,error:x,login:g,logout:b,refreshUserData:v},children:t})}function c(){let e=(0,n.useContext)(r);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},8222:function(e,t,s){"use strict";s.d(t,{hi:function(){return i}});class a extends Error{constructor(e,t){super(e),this.status=t,this.name="ApiError"}}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let s=await fetch(e,{...t,headers:{"Content-Type":"application/json",...t.headers}}),n=await s.json();if(!s.ok)throw new a(n.error||"An error occurred",s.status);return{data:n}}catch(e){return{error:e.message}}}let i={user:{getCurrentUser:async()=>n("/api/users?me=true"),getUserByUsername:async e=>n("/api/users/".concat(e)),updateUser:async e=>n("/api/users",{method:"PUT",body:JSON.stringify(e)}),listUsers:async function(){let{limit:e=10,offset:t=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n("/api/users?limit=".concat(e,"&offset=").concat(t))}},profile:{getProfile:async()=>n("/api/profile"),updateProfile:async e=>n("/api/profile",{method:"PUT",body:JSON.stringify(e)})},ipfs:{getContent:async function(){let{limit:e=10,offset:t=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n("/api/ipfs?limit=".concat(e,"&offset=").concat(t))},getContentByCid:async e=>n("/api/ipfs/".concat(e)),createContent:async e=>n("/api/ipfs",{method:"POST",body:JSON.stringify(e)}),updatePinStatus:async(e,t)=>n("/api/ipfs/".concat(e),{method:"PATCH",body:JSON.stringify({pinned:t})}),deleteContent:async e=>n("/api/ipfs/".concat(e),{method:"DELETE"})}}}},function(e){e.O(0,[126,792,971,69,744],function(){return e(e.s=5292)}),_N_E=e.O()}]);